# Команды

## `vk:check` - Проверка последних постов в группах

Проверяет последние посты во всех группах из списка `vk-groups.csv` и выводит таблицу с метриками.

**Использование:**
```bash
php artisan vk:check
php artisan vk:check --cached
php artisan vk:check --delay=1
```

**Параметры:**
- `--cached` - использовать кеш из предыдущего запуска (не делать запросы к API)
- `--delay=0.3` - задержка между запросами в секундах (по умолчанию 0.3)

**Примечание:** Результаты кешируются в таблице `vk_check_cache` базы данных для быстрого повторного просмотра.

---

## `vk:candidate` - Поиск кандидатов для републикации

Ищет посты со стены указанной группы/пользователя, которые можно использовать для републикации.

**Использование:**
```bash
php artisan vk:candidate --owner=-12345678
php artisan vk:candidate --owner=-12345678 --noreposts
```

**Параметры:**
- `--owner` - ID владельца стены (обязательный). Для групп используйте отрицательное число (например, `-12345678`)
- `--noreposts` - исключить посты, которые уже были отрепощены

**Примечание:** Команда проходит по всем постам стены, поэтому может занять время. Между постами есть задержка 5 секунд.

---

## `vk:dups` - Поиск дублей постов

Ищет посты, содержащие указанный текст (поиск по регулярному выражению).

**Использование:**
```bash
php artisan vk:dups --owner=-12345678 --text="текст для поиска"
```

**Параметры:**
- `--owner` - ID владельца стены (обязательный)
- `--text` - текстовый паттерн для поиска (обязательный). Поддерживает регулярные выражения

**Примеры:**
```bash
# Простой поиск
php artisan vk:dups --owner=-12345678 --text="важная новость"

# Поиск с регулярным выражением (case-insensitive)
php artisan vk:dups --owner=-12345678 --text="новость|объявление"
```

---

## `post:comments` - Получение комментариев к посту

Получает все комментарии к указанному посту.

**Использование:**
```bash
php artisan post:comments --owner=-12345678 --post=12345
```

**Параметры:**
- `--owner` - ID владельца стены (обязательный)
- `--post` - ID поста (обязательный)

---

## `comments:find` - Поиск комментариев автора

Ищет все комментарии указанного пользователя во всех постах группы.

**Использование:**
```bash
php artisan comments:find --owner=-12345678 --author=98765432
```

**Параметры:**
- `--owner` - ID владельца стены (группы) (обязательный)
- `--author` - ID автора комментариев (обязательный)

**Примечание:** Команда проходит по всем постам группы, что может занять значительное время для больших групп.

---

## `vk:groups-info` - Информация о группах

Получает и выводит информацию о всех группах из списка `vk-groups.csv`. Команда резолвит короткие имена групп в ID и получает полную информацию о каждой группе.

**Использование:**
```bash
php artisan vk:groups-info
```

**Примечание:** Команда использует progress bar для отображения прогресса обработки групп. Задержка между запросами: 0.5 секунды.

---

## `vk:posts-get` - Получение постов за период

Получает посты группы/пользователя за указанный временной период с возможностью фильтрации и экспорта данных.

**Использование:**
```bash
php artisan vk:posts-get --owner=-12345678 --from=2024-01-01
php artisan vk:posts-get --owner=-12345678 --from=2024-01-01 --to=2024-01-31
php artisan vk:posts-get --owner=-12345678 --from=2024-01-01 --format=json --output=posts.json
php artisan vk:posts-get --owner=-12345678 --from=2024-01-01 --db
```

**Параметры:**
- `--owner` - ID владельца стены (обязательный, отрицательное число для групп)
- `--from` - Дата начала периода (обязательный). Форматы: `YYYY-MM-DD`, `YYYY-MM-DD HH:MM:SS`, относительные даты (`today`, `yesterday`, `last week`)
- `--to` - Дата окончания периода (опциональный, по умолчанию текущая дата)
- `--format` - Формат вывода: `table`, `json`, `csv` (по умолчанию `table`)
- `--output` - Путь к файлу для сохранения результатов (опциональный, по умолчанию вывод в stdout)
- `--db` - Сохранить результаты в SQLite базу данных (вместо файла, без вывода в консоль)
- `--with-text-only` - Показывать только посты с текстом
- `--min-likes` - Минимальное количество лайков для фильтрации
- `--min-reposts` - Минимальное количество репостов для фильтрации

**Примечание:** При использовании опции `--db` данные сохраняются в таблицу `vk_posts` без вывода в консоль. Убедитесь, что миграции выполнены (`make migrate`).

---

## `vk:albums-get` - Получение списка фотоальбомов

Получает список фотоальбомов пользователя или сообщества VK с возможностью фильтрации и экспорта данных.

**Использование:**
```bash
php artisan vk:albums-get --owner=-12345678
php artisan vk:albums-get --owner=-12345678 --need-system
php artisan vk:albums-get --owner=-12345678 --format=json --output=albums.json
php artisan vk:albums-get --owner=-12345678 --min-size=10
php artisan vk:albums-get --owner=-12345678 --need-covers --format=csv --output=albums.csv
```

**Параметры:**
- `--owner` - ID владельца альбомов (обязательный, отрицательное число для групп)
- `--format` - Формат вывода: `table`, `json`, `csv` (по умолчанию `table`)
- `--output` - Путь к файлу для сохранения результатов (опциональный, по умолчанию вывод в stdout)
- `--need-system` - Включить системные альбомы (с отрицательными ID)
- `--need-covers` - Получить обложки альбомов (thumb_src)
- `--min-size` - Минимальное количество фотографий в альбоме для фильтрации

**Примечание:** Системные альбомы (например, "Фотографии со мной") имеют отрицательные ID и не содержат полей `description`, `created`, `updated`. При использовании опции `--need-covers` в ответе API появляется поле `thumb_src` с URL обложки альбома.


